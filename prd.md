# 产品需求文档 (PRD): “叙事导航者”回忆录决策规划系统

## 1. 项目背景与目标

### 1.1 背景

传统大模型在长程回忆录访谈中常面临“遗忘主线”、“提问浅尝辄止”或“逻辑跳跃”等痛点。

### 1.2 核心目标

- **解耦规划与生成**：研发独立的访谈决策规划模块 (**Planner**)，与自然语言生成 (**NLG**) 解耦。
- **结构化记忆构建**：实时构建并维护动态的“**人生事件图谱**”。
- **智能导航决策**：通过深度挖掘 (*Depth-expansion*) 与广度跳转 (*Breadth-switching*) 博弈，平衡访谈的深度与覆盖率。

---

## 2. 核心架构与逻辑

### 2.1 核心规划层 (Core Planner)

**Planner** 通过“状态-价值-策略”三层架构实现决策：

1.  **状态感知层**：从回答中剥离人物、地点、时间等实体，进行槽位填充（如初恋节点的相识、情感冲突等）和时序锚定。
2.  **价值评估层**：监测“情绪能量”（语气词、情感强度）、信息密度及叙事独特性，为节点计算权重。
3.  **策略决策层**：基于当前图谱状态，决定下一步动作类型（深度、广度、纠偏）。

### 2.2 工作流 (Workflow)

- **接收响应**：获取用户回答并调用 **LLM API** 进行事件抽取。
- **更新图谱**：使用 **NetworkX** 更新事件图谱，计算当前覆盖率与深度。
- **导航输出**：根据节点状态执行 `Depth_Dive`（高价值事件深度追问）或 `Breadth_Switch`（低覆盖或疲劳时跳转）。

---

## 3. 功能需求

### 3.1 导航决策引擎

| 动作类型 | 策略逻辑 | 触发场景示例 |
| :--- | :--- | :--- |
| **深度挖掘** | 引导阀值、由“事”及“人”、感官触发 | “核心事件”槽位未满，且“情绪能量”高 |
| **广度跳转** | 物理跳转、社交网络跳转、时代快照、情感共振 | 当前节点信息密度衰减，或检测到用户话题疲劳 |
| **纠偏机制** | 矛盾检测与温和确认 | 发现新的叙事与已有节点存在逻辑/时间冲突 |

### 3.2 结构化指令集 (Planner Output)

**Planner** 不直接生成文本，而是输出包含以下字段的 **JSON** 指令：

- `Current_Focus`：锁定当前上下文（如：1992 创业阶段）。
- `Primary_Action`：规定动作类型（`Deep_Dive` / `Breadth_Switch`）。
- `Tactical_Goal`：明确要挖掘的信息点（如：提取失败时的情绪）。
- `Tone_Constraint`：约束语气（如：共情、支持）。

### 3.3 动态事件图谱可视化

- **时间轴森林图**：纵向展示生平时间轴，横向展示家庭、职业等维度。区分已挖透、提及未展开、预设待触达三种节点状态。
- **覆盖率仪表盘**：实时展示访谈在时间（童年、青年等）与维度（行为、细节、情感、反思）上的完备度。

---

## 4. 评估体系与仿真环境

### 4.1 用户模拟器

#### 4.1.1 设计目标

构建基于 **LLM** 的模拟受访者，用于在无需真实用户参与的情况下，对 **Baseline Agent**（无 Planner）和 **带 Planner 的完整系统** 进行自动化对比评估。

#### 4.1.2 Persona 类型定义

| 类型 | 特征 | 回答模式 | 测试目的 |
|:---|:---|:---|:---|
| **健谈型** | 表达欲强，细节丰富 | 每轮 200-300 字，主动延伸话题 | 验证系统信息提取与话题收敛能力 |
| **沉默型** | 回答简短，需要引导 | 每轮 20-50 字，被动回答 | 验证系统追问与深度挖掘能力 |
| **跳跃型** | 思维发散，容易跑题 | 频繁切换话题，关联性弱 | 验证 Planner 的话题回归与纠偏能力 |
| **逻辑型** | 结构清晰，条理分明 | 按时间/因果叙述，少情绪 | 验证系统对情感维度的覆盖 |

#### 4.1.3 模拟器实现架构

```
┌─────────────────────────────────────────────────────────────┐
│                      UserSimulator                          │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │  Persona    │  │  Memory     │  │   Response  │         │
│  │  Profile    │→ │   Bank      │→ │  Generator  │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
│         │               │               │                   │
│         ↓               ↓               ↓                   │
│  性格模板预设    预设人生故事库    LLM 驱动生成              │
└─────────────────────────────────────────────────────────────┘
```

#### 4.1.4 预设人生故事模板

每个 Persona 配套一份结构化的人生故事模板，涵盖：

```yaml
life_template:
  childhood:
    - 出生背景（年代、地点、家庭环境）
    - 童年趣事（1-2 个可展开事件）
  education:
    - 求学历程
    - 重要老师/同学
  career:
    - 第一份工作
    - 职业转折点
    - 成就或挫折
  family:
    - 婚恋经历
    - 子女教育
  turning_points:
    - 人生重大决策
    - 困难与克服
```

#### 4.1.5 对话生成逻辑

模拟器接收 Agent 问题后，执行以下流程：

1. **意图识别**：分析问题所属维度（时间/情感/细节/反思）
2. **记忆检索**：从预设故事库中匹配相关事件
3. **Persona 过滤**：根据类型调整回答长度、风格
4. **疲劳模拟**：长对话后逐步降低回答质量（测试系统适应能力）

#### 4.1.6 仿真测试流程

```python
# 伪代码示例
def run_simulation(agent_type, persona_type, max_turns=20):
    simulator = UserSimulator(persona_type)
    agent = BaselineAgent() if agent_type == 'baseline' else PlannerAgent()

    conversation_log = []
    for turn in range(max_turns):
        # Agent 发问
        question = agent.get_next_question()
        # 模拟器回答
        answer = simulator.generate_response(question)
        # Agent 处理
        agent.process_response(answer)

        conversation_log.append({
            'turn': turn,
            'question': question,
            'answer': answer,
            'action': agent.last_action  # Planner 决策动作
        })

    return evaluate(conversation_log)
```

#### 4.1.7 对比评估维度

| 指标 | Baseline Agent | 带 Planner Agent |
|:---|:---:|:---:|
| **话题覆盖率** | 随机/依赖用户引导 | 主动规划覆盖 |
| **平均对话深度** | 浅尝辄止 | 深度优先挖掘 |
| **话题切换平滑度** | 突兀 | 基于图谱平滑过渡 |
| **疲劳适应性** | 无法检测 | 检测并调整策略 |

#### 4.1.8 输出产物

每次仿真运行生成：
- **对话日志**：完整问答记录
- **事件图谱**：构建出的用户人生图谱
- **评估报告**：覆盖率、深度、连贯性量化分数

### 4.2 监控指标

- **话题覆盖率**：衡量预设大纲节点被触达的比例。
- **平均对话深度**：衡量对关键事件挖掘的细致程度。
- **逻辑连贯性**：评估话题切换是否平滑及是否存在矛盾。

---

## 5. 访谈规程 (VIP: Life Story Interview)

Planner 预设大纲基于 McAdams 的《人生故事访谈》规程，构建一个"领域-主题-种子问题"的三维矩阵。

### 5.1 规程结构

| 领域 | 主题数量 | 核心目标 |
|:---|:---:|:---|
| **人生篇章** | 1 | 构建时间轴骨架，划分人生阶段 |
| **关键场景** | 8 | 挖掘高光、低谷、转折点等标志性事件 |
| **未来剧本** | 3 | 探索期望、梦想与人生计划 |
| **挑战** | 4 | 直面困难、健康、失落与遗憾 |
| **个人意识形态** | 4 | 提炼价值观与信仰体系 |
| **上下文管理** | 3 | 会话摘要与信息整合 |

### 5.2 二十三主题详解

#### 5.2.1 人生篇章

**主题 1：人生篇章概览**

> 请参与者将自己的人生想象成一本书，思考其人生故事的主要篇章，为每个篇章提供标题和简短的描述。

**种子问题**：
1. 如果将自己的人生想象成一本书，目录会是什么样的？你能为你人生的每个篇章起一个标题吗？
2. 让我们从你提到的第一个篇章开始。你能简要描述一下你人生的这个部分是关于什么的吗？
3. 这个篇章的主要事件或主题是什么？
4. 这个篇章是如何过渡到下一个篇章的？哪些变化或事件标志着下一个篇章的开始？
5. 当我们从一个篇章过渡到下一个篇章时，你能找出任何转折点或重要的事件，它们开启了你人生的新阶段吗？

#### 5.2.2 关键场景

**主题 2：高潮 (Peak Experience)**

> 讨论参与者人生中的一些关键场景，重点关注高潮：一个巅峰时刻。

**种子问题**：
1. 你能描述一个让你觉得是你人生巅峰体验的时刻吗？是什么让这个时刻如此积极？
2. 这个高潮发生在何时何地？当时有哪些人在场？
3. 你当时在想什么，感觉如何？
4. 你为什么认为这个时刻对你的人生故事如此重要？它揭示了你是一个怎样的人？

**主题 3：低谷 (Low Point)**

> 讨论参与者人生中的一些关键场景，重点关注"低谷"：一个充满挑战或困难的时刻。

**种子问题**：
1. 想想你生命中感觉像低谷的时刻。你能分享一下发生了什么以及为什么如此困难吗？
2. 这个事件发生在何时何地？还有谁参与其中？
3. 在这个充满挑战的时期，你的感受如何？
4. 回顾过去，这个低谷对你的人生或自我认知产生了什么影响？

**主题 4：转折点 (Turning Point)**

> 讨论参与者人生中的一些关键场景，重点关注"转折点"：一个重大改变的时刻。

**种子问题**：
1. 你能确定人生的一个转折点吗？一个标志着你或你人生方向发生重大改变的事件？
2. 请描述一下这个事件的背景。何时何地发生的，以及谁参与其中？
3. 这个事件之后发生了哪些变化？
4. 为什么你认为这个事件是一个转折点？它如何影响了你之后的人生篇章？

**主题 5：童年积极回忆**

> 讨论参与者人生中的一些关键场景，重点关注童年积极回忆。

**种子问题**：
1. 你还记得童年或青少年时期特别快乐的回忆吗？请分享一下。
2. 具体发生了什么，何时何地？
3. 谁参与了这段回忆，当时你在想什么，感觉如何？
4. 为什么这段回忆让你印象深刻，它在你的人生故事中有什么意义？

**主题 6：童年消极回忆**

> 讨论参与者人生中的一些关键场景，重点关注童年消极回忆。

**种子问题**：
1. 你能描述一下早年一段困难或不快乐的回忆吗？
2. 当时发生了什么，何时何地？
3. 谁参与了，当时你经历了哪些情绪？
4. 这段回忆如何影响了你或你的人生观？

**主题 7：生动的成人记忆**

> 讨论参与者人生故事中的一些关键场景，重点关注生动的成人记忆。

**种子问题**：
1. 回顾您的成年岁月，您能描述一个至今尚未讨论过的、特别生动或有意义的场景吗？
2. 发生了什么事，它发生在何时何地？
3. 谁参与其中，您当时主要的想法和感受是什么？
4. 这个记忆为何如此重要，它如何融入您的人生整体故事？

**主题 8：宗教、精神或神秘体验**

> 讨论参与者人生中的一些关键场景，重点关注宗教、精神或神秘体验。

**种子问题**：
1. 您是否曾有过一次与超越自身的事物（无论是宗教、精神还是神秘的）产生深刻联系的时刻？
2. 请详细描述这次经历，包括它发生的地点、时间以及与谁一起。
3. 这次经历伴随着怎样的想法和感受？
4. 这次经历对您的信仰或您对世界的理解产生了怎样的影响？

**主题 9：智慧事件**

> 讨论参与者人生中的一些关键场景，重点关注智慧事件：他们展现或遇到智慧的时刻。

**种子问题**：
1. 您能回想起自己展现智慧的时刻吗？也许是做了一个明智的决定或给出了深思熟虑的建议。
2. 描述一下发生了什么，包括具体的地点、时间和参与人员。
3. 那时您在想什么，感受如何？
4. 这个事件说明了您的哪些价值观或生活方式？

#### 5.2.3 未来剧本

**主题 10：下一章**

> 探讨参与者未来期望、希望和计划，重点关注下一章。要求他们推测自己生活的近期未来。

**种子问题**：
1. 展望未来，您认为您人生故事的下一章是什么？您能描述一下您预期的发展吗？
2. 您期望哪些事件或里程碑将定义您人生的下一阶段？
3. 谁将是下一章的关键人物，他们将扮演什么角色？
4. 在即将到来的这一章中，您是否有任何特定的目标或追求？

**主题 11：梦想、希望和未来计划**

> 深入了解参与者对未来的期望、希望和计划，重点关注梦想与计划：讨论他们的希望、梦想和计划。

**种子问题**：
1. 您能否分享一些您对未来的梦想或希望？您有哪些渴望实现的目标？
2. 您是否有具体的计划或策略来实现这些梦想？您能描述一下吗？
3. 这些梦想和计划如何与您迄今为止的人生故事中提到的价值观和经验相吻合？
4. 您预计在实现这些目标的过程中会面临哪些挑战，以及您打算如何克服它们？

**主题 12：人生项目**

> 深入了解参与者对未来的期望、希望和计划，重点关注人生项目：询问对他们而言意义重大的正在进行或计划中的项目。

**种子问题**：
1. 您目前是否正在进行某个特别的项目或事业，或者计划承担某个项目或事业，让您觉得这是您人生工作的重要组成部分？
2. 您是如何参与到这个项目中的，或者您打算如何参与？
3. 这个项目的目标是什么，为什么它对您或他人很重要？
4. 在接下来的几年里，您认为这个项目将如何发展？您希望它产生什么影响？

#### 5.2.4 挑战

**主题 13：人生挑战**

> 探讨参与者面临的各种挑战，重点关注人生挑战：他们一生中面临的最大挑战。

**种子问题**：
1. 回顾您的一生，您认为您所面临的最大挑战是什么？
2. 您能描述一下这个挑战的背景吗？它发生在什么时候，涉及哪些人？
3. 当时您是如何应对或处理这个挑战的？
4. 回头看，这个挑战在您的人生故事中有什么意义？

**主题 14：健康**

> 探讨参与者所面临的各种挑战，重点关注健康：他们或他们亲近的家人所面临的重大健康问题、挑战或危机。

**种子问题**：
1. 你或你的亲人曾经面临过重大的健康问题吗？你能分享一下这次经历的细节吗？
2. 这个健康问题是如何发生的？时间线是怎样的？
3. 在此期间，你与医疗系统有哪些互动？这些互动对情况产生了什么影响？
4. 你是如何应对这个健康挑战的？它对你的生活和看法产生了哪些持久的影响？

**主题 15：失落**

> 探讨参与者所面临的各种挑战，重点关注失落：他们所经历的最重大的的人际失落。

**种子问题**：
1. 失落是生活中不可避免的一部分。你能描述一下你所经历的最重大的失落吗？无论是亲人的离世还是其他形式的分离？
2. 这次失落发生在何时？涉及哪些人？
3. 当时你是如何应对这次失落的？现在又是如何继续处理的？
4. 这次失落对你和你的人生故事产生了什么影响？

**主题 16：失败的遗憾**

> 探讨参与者所面临的各种挑战，重点关注失败或遗憾：他们所面临的最重大的单次失败或遗憾。

**种子问题**：
1. 每个人都会经历失败和遗憾。你能谈谈你生活中特别突出的某次失败或遗憾吗？
2. 导致这种情况发生的原因是什么？涉及哪些人？发生在何时？
3. 你是如何应对这次经历的？你从中吸取了哪些教训？
4. 这次失败或遗憾对你未来的决定或人生道路产生了什么影响？

#### 5.2.5 个人意识形态

**主题 17：宗教/伦理价值观**

> 深入探讨参与者的基本信仰和价值观，重点关注宗教和伦理价值观。

**种子问题**：
1. 您能描述一下您的宗教或精神信仰，以及它们如何影响您的日常生活吗？
2. 无论您是否认为自己有宗教信仰，您将如何描述您的人生伦理或道德方法？
3. 在您人生的艰难时期，您的宗教或精神信仰是如何支持或挑战您的？

**主题 18：政治/社会价值观**

> 深入探讨参与者的基本信仰和价值观，重点关注政治和社会价值观。

**种子问题**：
1. 您对政治或社会问题的立场是什么？您是否认同某种特定的政治意识形态或运动？
2. 是否有一些特定的社会问题或事业让您特别充满热情？您能否解释它们对您为什么重要？
3. 您的政治或社会价值观如何影响您与他人的互动以及您对社区的参与？

**主题 19：宗教和政治观点转变和发展**

> 深入探讨参与者的基本信仰和价值观，重点关注观点演变：他们的信仰和价值观如何随时间而变化。

**种子问题**：
1. 回顾您的人生，您的宗教、道德或政治观点是如何改变或发展的？
2. 您能描述一下您生命中的一个事件或一个时期，它对您的观点产生了重大影响或改变了吗？
3. 您的信仰和价值观的变化是如何影响您的决定和关系的？

**主题 20：单一价值观**

> 深入探讨参与者的基本信仰和价值观，重点关注关键价值观：他们生命中最重要的价值观。

**种子问题**：
1. 您认为在人类生活中最重要的价值观是什么？为什么？
2. 这个价值观在您的一生中是如何指导您的行动和选择的？
3. 您能举一个例子，说明这个价值观在某个时候特别受到考验或得到肯定的经历吗？

#### 5.2.6 上下文管理

**主题 21-23：会话摘要与整合**

> 在每次会话结束后，提炼主要思想形成上下文摘要，供后续会话使用。

---

## 6. 记忆图驱动外推 (MGE)

### 6.1 核心流程

MGE (Memory Graph Extrapolation) 作为由 LLM 驱动的功能运行，对记忆执行以下操作：

```
┌─────────────────────────────────────────────────────────────┐
│                    MGE 循环流程                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌──────────┐    ┌──────────┐    ┌──────────┐            │
│   │  提取    │───▶│  合并    │───▶│  外推    │            │
│   │Extraction│    │  Merging │    │Extrapolate│            │
│   └──────────┘    └──────────┘    └──────────┘            │
│        │               │               │                   │
│        ▼               ▼               ▼                   │
│  从对话中识别     将新事件与      基于图谱状态             │
│  事件节点        现有事件合并    生成个性化问题            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 6.2 事件提取格式

Planner 调用 IE 模块，强制输出以下格式：

```
<日期>#<主题>#<涉及人员>#<详细描述>
```

**示例**：
```
1980年初#生日聚会#Michelle, Adolf, 邻居#这次聚会来的人很多，大家都很高兴...
```

### 6.3 外推策略

基于当前图谱状态，MGE 执行三种外推模式：

| 模式 | 触发条件 | 动作 |
|:---|:---|:---|
| **空白填充** | 某时期节点密度低于阈值 | 触发 Breadth_Switch 到该时期 |
| **人物聚类** | 某人连接多个事件 | 生成针对该人的专项问题 |
| **冲突激发** | 新事件与旧事件不一致 | 触发 Clarification 动作 |

---

## 7. 深度扩展策略详解

### 7.1 策略触发条件

当检测到以下条件时，执行 Deep Dive：
- "核心事件"槽位未满
- "情绪能量"高
- 用户当前回答字数 < 30 字且没有实体时，必须执行感官诱导

### 7.2 三种深度路径

#### 路径 A：由"事"及"人"（归纳法）

| 属性 | 描述 |
|:---|:---|
| **定位** | 最基础、最稳健的路径 |
| **动作** | 按照时间轴索要事实 |
| **演进** | 当事件足够多时，计算节点的关键词重合度 |
| **示例** | 老人提到 5 个事件都涉及"独自承担风险"，Planner 自动提炼出性格标签"孤勇" |
| **适用场景** | 访谈早期，建立信任和基础素材库 |

#### 路径 B：由"物"及"情"（感官触发法）

| 属性 | 描述 |
|:---|:---|
| **定位** | 针对老人对抽象时间模糊、对物品记忆深刻的特点 |
| **动作** | 主动抛出感官锚点（照片、老物件、老地名） |
| **演进** | 物品 → 关联事件 → 时代记忆 |
| **示例** | "您家里现在还留着当年的那枚军功章吗？" → 引发对授勋仪式的描述 |
| **适用场景** | 陷入僵局或老人出现"记忆疲劳"时 |

#### 路径 C：由"时代"及"个体"（演绎法）

| 属性 | 描述 |
|:---|:---|
| **定位** | 利用大模型知识库，将个人置于历史背景中 |
| **动作** | 调取时代背景库（如：90 年代下海潮） |
| **演进** | 时代趋势 → 询问老人在其中的位置 → 获得独特叙事 |
| **示例** | "1992 年南巡讲话后，很多人都辞职了，那时候您所在的单位有什么变化吗？" |
| **适用场景** | 提升回忆录的厚度，让个人史具备社会学价值 |

### 7.3 深度判停准则

针对一个事件，如果已收集 4 个以上要素且用户情绪能量下降，Planner 必须执行 Breadth_Switch：

**事件要素清单**：
- [ ] 时间
- [ ] 地点
- [ ] 人物
- [ ] 起因
- [ ] 结果
- [ ] 感受

---

## 8. 广度跳转策略详解

### 8.1 跳转概率公式

$$Switch\_Probability = \alpha \cdot (1 - \text{Current\_Information\_Density}) + \beta \cdot \text{User\_Fatigue\_Score}$$

当信息密度掉到阈值以下，或者用户疲劳度上升时，Planner 立即停止 Deep Dive。

### 8.2 五种跳转路径

#### 路径 1：物理/地理跳转 (Spatial Jumping)

| 属性 | 描述 |
|:---|:---|
| **策略** | 从当前地点延伸到下一个地点 |
| **示例** | "您刚才提到在上海厂里工作的事，后来我看您档案里还去过西安，那次跨越大半个中国的搬家是怎么发生的？" |
| **产品逻辑** | 人的记忆往往和物理空间绑定（家、学校、工厂） |

#### 路径 2：人物社交网络跳转 (Social Network Jumping)

| 属性 | 描述 |
|:---|:---|
| **策略** | 利用图谱中已识别但未展开的人物 |
| **示例** | "刚才您聊奋斗史的时候多次提到了您的爱人，咱们聊了很久您的工作，还没听您讲讲您和她最初是怎么认识的？" |
| **产品逻辑** | 带有"情感钩子"，老人乐意从聊事转向聊重要的人 |

#### 路径 3：时代快照跳转 (Historical Snapshot)

| 属性 | 描述 |
|:---|:---|
| **策略** | 抛出时代标志性事件，询问老人在那个时刻的坐标 |
| **示例** | "咱们聊了不少家常，我突然想到，1997年香港回归那天，您还记得自己在做什么吗？" |
| **产品逻辑** | 适合在某个节点"挖透了"或老人表现出疲劳时，用宏大话题提神 |

#### 路径 4：情感/动机共振跳转 (Affective Association)

| 属性 | 描述 |
|:---|:---|
| **策略** | 抓住老人表达的情绪，引导到另一个具有相同情绪的人生时刻 |
| **示例** | "我能感受到您提起这件事时那股不服输的劲儿。您这一辈子，还有没有哪个时刻，也像这次一样让您觉得自己'绝不认输'？" |
| **产品逻辑** | 打破时间线束缚，通过性格特征串联跨度巨大的事件 |

#### 路径 5："挂起任务"回溯跳转 (Task Resume)

| 属性 | 描述 |
|:---|:---|
| **策略** | 翻出之前被"打断"或"挂起"的话题 |
| **示例** | "刚才咱们聊得太投入，把您小时候在乡下赶集的那段给绕过去了，现在咱们能不能回过头再讲讲那次赶集？" |
| **产品逻辑** | 确保覆盖率（Recall）的硬性保障 |

### 8.3 跳转优先级

| 优先级 | 路径类型 | 理由 |
|:---:|:---|:---|
| **1 (首选)** | 情感/人物路径 | 体验最好，老人感觉被理解 |
| **2 (次选)** | 物理/时序路径 | 逻辑最稳，适合构建回忆录结构 |
| **3 (末选)** | 时代/任务回溯 | 适合对话尴尬或强行补全覆盖率时使用 |

---

## 9. 指令输出层设计

### 9.1 解耦原则

Planner 不直接生成对话文本，而是输出结构化的"战术指令"给对话模块。

### 9.2 指令格式

```json
{
  "Current_Focus": "1992_Startup_Phase",
  "Primary_Action": "Deep_Dive",
  "Tactical_Goal": "Extract_Failure_Emotions",
  "Tone_Constraint": "Empathic_Supportive",
  "Context_Bridge": "User_mentioned_Brother_Wang",
  "Focus_Facet": "Emotion",
  "Target_Node": "1978_University_Entry"
}
```

### 9.3 字段说明

| 字段 | 示例内容 | 目的 |
|:---|:---|:---|
| `Current_Focus` | `1992_Startup_Phase` | 锁定当前上下文 |
| `Primary_Action` | `Deep_Dive` / `Breadth_Switch` | 规定动作类型 |
| `Tactical_Goal` | `Extract_Failure_Emotions` | 明确要挖掘的信息点 |
| `Tone_Constraint` | `Empathic_Supportive` | 约束生成模块的语气 |
| `Context_Bridge` | `User_mentioned_Brother_Wang` | 提供衔接用的上下文钩子 |
| `Focus_Facet` | `Emotion` / `Details` / `Reflections` | 聚焦维度 |
| `Target_Node` | `1978_University_Entry` | 目标事件节点 |

---

## 10. 宏观覆盖率逻辑

### 10.1 全局视图

Planner 维持全局视图，确保"人生不留白"。

### 10.2 进度计算

按照预设的"人生大纲"，实时计算每个区域的挖掘百分比：

$$Coverage = \frac{\sum (\text{已挖掘节点} \times \text{深度权重})}{\text{预设大纲总节点数}}$$

### 10.3 多维完整性校验

优秀的传记包含五个维度，Planner 需确保各维度的覆盖：

| 维度 | 描述 | 评估指标 |
|:---|:---|:---|
| **时间** | 人生阶段覆盖 | 童年、青年、中年、晚年的比例 |
| **空间** | 地理/场景覆盖 | 生活地点、工作场所、重要场所 |
| **人物** | 关键人物网络 | 家人、朋友、同事、导师 |
| **情感** | 情绪深度挖掘 | 高峰、低谷、转折的情绪记录 |
| **反思** | 价值观提炼 | 人生感悟、经验总结 |

### 10.4 动态调整机制

如果某阶段谈得太久（导致老人疲劳），Planner 会强行在下一轮引入"转折点"，加速进入下一个生命周期。

---

## 11. 项目时间规划

### 阶段一：标准定义与 Baseline 搭建 (Week 1)

| 任务 | 交付物 |
|:---|:---|
| Planner 指令集标准定义 | JSON 指令协议文档 |
| 访谈规程实例化 | 23 个主题的种子问题库 |
| 评估指标代码化 | 有效轮次、语义等价性计算脚本 |
| 环境准备 | Python 环境、LLM API 接入 |
| Baseline 开发 | 无 Planner 的纯对话 Agent |
| 样本清洗 | User Simulator 的 RAG 向量库 |
| User Simulator 搭建 | 模拟受访者实现 |

### 阶段二：Planner 核心算法开发 (Week 2-4)

| 周次 | 核心任务 | 关键交付材料 |
|:---|:---|:---|
| **Week 2** | 事件提取与挂载 (MGE) | 1. Event Extractor 模块<br>2. 时序对齐逻辑说明<br>3. 初步生命图谱 (JSON) |
| **Week 3** | 深度扩展路径开发 | 1. 深度导航算法策略代码<br>2. 槽位填充度评分函数<br>3. 深度路径测试 Case 集 |
| **Week 4** | 广度跳转实现 | 1. 广度跳转策略逻辑库<br>2. 疲劳度计分模型<br>3. Planner 决策引擎完整版 |

### 阶段三：可视化呈现与系统集成 (Week 5-6)

| 周次 | 核心任务 | 关键交付材料 |
|:---|:---|:---|
| **Week 5** | 动态图谱可视化工具开发 | 1. 可视化前端原型<br>2. 图谱状态同步接口定义 |
| **Week 6** | 系统集成与柔性导航调优 | 1. "叙事导航者"集成系统演示版<br>2. 桥接语生成 Prompt 模版库<br>3. 系统联调测试报告 |

### 阶段四：仿真评估与数据实验 (Week 7-9)

| 周次 | 核心任务 | 关键交付材料 |
|:---|:---|:---|
| **Week 7** | 大规模仿真测试 | 1. 自动化测试原始数据库<br>2. Simulator 运行状态监控表 |
| **Week 8** | 评估计算与统计分析 | 1. 多维评估指标计算脚本<br>2. 访谈质量对比原始数据图表 |
| **Week 9** | 主题升华与产品调优 | 1. 主题提炼模块<br>2. 算法性能优化记录文档 |

### 阶段五：结项交付与演示 (Week 10)

| 任务 | 交付物 |
|:---|:---|
| 项目终期交付 | 《叙事导航者：技术研究与评估报告》 |
| 系统演示 | 项目演示视频 (Demo Video) |
| 代码整理 | 完整源码仓库 (GitHub/GitLab) |

---

## 12. 关键技术选型

### 12.1 图谱存储

| 技术方案 | 说明 | 节点属性 |
|:---|:---|:---|
| **Neo4j** | 图数据库方案（可选） | ID, 阶段, 核心事件, 挖掘深度(0-5), 关键词, 关联人物 |
| **JSON-Graph** | 轻量级方案（推荐） | 同上 |

### 12.2 信息提取 (IE) 逻辑

- **LLM-based NER & RE**：每轮对话后，提取 (Subject, Relation, Object)
- **时序对齐**：采用时间轴对齐算法，将凌乱的回忆归位

### 12.3 LLM 选型

- **主要模型**：混元 / GPT-4
- **评估模型**：GPT-4（用于语义等价性评判）

---

## 13. 关键交付物清单

| 类别 | 交付物名称 | 关键特性 |
|:---|:---|:---|
| **算法** | Navigator-Planner API | 接收历史对话，输出 JSON 决策指令 |
| **前端** | Life-Graph Visualizer | 实时展示 23 个主题节点的生长状态 |
| **实验** | Simulation Benchmark | 包含对比数据的 PDF 报告及有效性证明 |
| **内容** | Prompt Library | 包含 23 个主题的种子问题及感官诱导库 |

---

## 14. 产品理念与约束

### 14.1 隐私与伦理

| 风险类型 | 处理策略 |
|:---|:---|
| **无内容风险** | 情感引导上的支持 |
| **有内容风险** | 简单回避，重要性靠后由安全部门介入 |

### 14.2 个性化大纲

- 从通用模板（童年、求学、工作、家庭）开始
- 根据老人背景（如知青经历、军旅生涯）进行定制

### 14.3 采访模式

- 支持 Top-down 和 Bottom-up 两种模式
- 根据效果动态调整

---

## 15. 参考文献与相关工作

### 15.1 GuideLLM

- **VIP 规程**：人生故事访谈 (McAdams, 2008)
- **MGE 流程**：提取-合并-外推循环
- **User Simulator**：基于 RAG 的模拟受访者

### 15.2 StorySage

- 多智能体框架：面试官、记录员、规划者、撰写者、协调员
- 人机协同创作方法

### 15.3 Second Me

- 实体与关系提取技术参考
